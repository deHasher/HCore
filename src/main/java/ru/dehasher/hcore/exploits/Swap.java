package ru.dehasher.hcore.exploits;

import java.util.HashMap;

import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.EventPriority;
import org.bukkit.event.Listener;
import org.bukkit.event.player.PlayerSwapHandItemsEvent;

import ru.dehasher.hcore.HCore;

public class Swap implements Listener {

	public Swap(HCore plugin) {}

	private final HashMap<Player, Long> swapDelay = new HashMap<>();

	private HashMap<Player, Long> getSwapDelay() {
		return swapDelay;
	}

	@EventHandler(priority = EventPriority.HIGHEST)
	public void onPlayerSwapHandItemsEvent(PlayerSwapHandItemsEvent e) {
		if (!HCore.config.getBoolean("settings.fix-exploits.swap")) return;
		Player player = e.getPlayer();

        if (!getSwapDelay().containsKey(player)) {
			getSwapDelay().put(e.getPlayer(), 0L);
		}

		if (System.currentTimeMillis() < getSwapDelay().get(player)) {
			e.setCancelled(true);
		} else {
			getSwapDelay().put(player, System.currentTimeMillis() + 750L);
		}
	}
}
